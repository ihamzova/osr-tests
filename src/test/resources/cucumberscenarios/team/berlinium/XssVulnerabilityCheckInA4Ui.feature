Feature: [DIGIHUB-106423][Berlinium] XSS Security checks for A4 Inventory UI

  Background:
    Given user "autotest.berlinium" with password "autotest.03-Berlinium" is logged in to "a4-resource-inventory-ui"

  @berlinium @domain
    @a4-resource-inventory-ui @a4-resource-inventory-bff-proxy @a4-resource-inventory
  Scenario Outline: Check robustness of A4 Inventory UI against persistent XSS attack
    Given a NEG with name "<EvilString>" is existing in A4 resource inventory
    When the user navigates to NEG search page
    And clicks the NEG search submit button
    Then 1 NEG in the search result list has name "<EvilString>"
    # If the javascript alert part in the string would've been executed, the value wouldn't be visible in page.
    # Therefore: Because the expected value _is_ visible, the XSS attack wasn't successful.

    Examples:
      | EvilString                                           |
      | <script type='text/javascript'>alert('XSS')</script> |

  @berlinium @domain
    @a4-resource-inventory-ui @a4-resource-inventory-bff-proxy @a4-resource-inventory
  Scenario Outline: Check robustness of A4 Inventory UI against DOM-based XSS attack
    Given a NE is existing in A4 resource inventory
    When the user searches for NE on Mobile Search page
    And enters Inbetriebnahme page URL with VPSZ query parameter "<EvilString>"
    Then the value of shown VPSZ is "<EvilString>"
    # Again, the fact that the value is fully displayed in the ui shows that the XSS attack doesn't work.

    Examples:
      | EvilString                                           |
      | <script type='text/javascript'>alert('XSS')</script> |
